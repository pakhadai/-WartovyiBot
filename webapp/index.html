<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Bot Control Panel</title>

    <!-- Шрифти -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Іконки -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lucide@latest/font/lucide.min.css">

    <!-- Стилі (використовуйте CSS з попереднього артефакту) -->
    <link rel="stylesheet" href="css/style.css">

    <!-- Telegram Web App -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <!-- Toast сповіщення -->
    <div id="toast-notification" class="toast"></div>

    <!-- Основний контейнер -->
    <main id="app-container">

        <!-- Головна сторінка -->
        <div id="home-page" class="page active">
            <header class="page-header">
                <img src="logo-rm.png" alt="Bot Logo" class="logo">
                <h1 data-translate="welcome_title">Вітаємо!</h1>
                <p class="subtitle" data-translate="welcome_subtitle">Це ваша персональна панель керування ботом.</p>
            </header>

            <div class="card">
                <h2 data-translate="features_title">Основні функції</h2>
                <ul>
                    <li>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
                        </svg>
                        <span data-translate="feature_captcha">Розумна CAPTCHA для нових учасників</span>
                    </li>
                    <li>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                        <span data-translate="feature_spam_filter">Гнучкий спам-фільтр з системою балів</span>
                    </li>
                    <li>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="13" r="4"/>
                            <path d="M12 3v6M12 17v4M3 12h6M15 12h6"/>
                        </svg>
                        <span data-translate="feature_punishments">Автоматичні покарання для порушників</span>
                    </li>
                    <li>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
                            <circle cx="12" cy="12" r="3"/>
                        </svg>
                        <span data-translate="feature_individual_settings">Індивідуальні налаштування для кожної групи</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Сторінка налаштувань -->
        <div id="settings-page" class="page">
            <header class="page-header">
                <h1 data-translate="settings_title">Налаштування</h1>
                <p class="subtitle" data-translate="settings_subtitle">Керуйте параметрами для обраного чату</p>
            </header>

            <div class="card">
                <h2 data-translate="select_chat_title">Вибір групи/каналу</h2>
                <select id="chat-selector" class="chat-selector">
                    <option value="" data-translate="loading_chats">Завантаження...</option>
                </select>
            </div>

            <div id="settings-content" class="hidden">
                <section class="card">
                    <h2 data-translate="general_settings_title">Загальні налаштування</h2>
                    <div id="settings-loader" class="loader" style="display: none;"></div>
                    <div id="settings-container">
                        <div class="setting-item">
                            <label for="captcha-toggle" data-translate="captcha_toggle_label">CAPTCHA для нових</label>
                            <label class="switch">
                                <input type="checkbox" id="captcha-toggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label for="spamfilter-toggle" data-translate="spamfilter_toggle_label">Спам-фільтр</label>
                            <label class="switch">
                                <input type="checkbox" id="spamfilter-toggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label for="spam-threshold" data-translate="spam_threshold_label">Поріг спаму</label>
                            <input type="number" id="spam-threshold" min="5" max="50" step="5"
                                   style="width: 70px; padding: 8px 12px; border: 1px solid var(--gray-light); border-radius: 8px; font-size: 15px;">
                        </div>
                        <div class="setting-item">
                            <label for="antiflood-toggle" data-translate="antiflood_toggle_label">Анти-флуд система</label>
                            <label class="switch"><input type="checkbox" id="antiflood-toggle"><span class="slider round"></span></label>
                        </div>
                        <div class="setting-item" id="antiflood-sensitivity-container">
                            <label for="antiflood-sensitivity" data-translate="antiflood_sensitivity_label">Чутливість флуду</label>
                            <input type="number" id="antiflood-sensitivity" min="3" max="15" step="1" style="width: 60px; padding: 5px; border: 1px solid var(--tg-hint); border-radius: 4px;">
                        </div>
                    </div>
                </section>

                <section class="card">
                    <h2 data-translate="punishments_title">Гнучкі покарання</h2>
                    <div id="punishments-container">
                        <div class="punishment-rule">
                            <label data-translate="punishment_level_1">1-ше попередження</label>
                            <div class="punishment-controls">
                                <select class="action-selector" data-level="1">
                                    <option value="mute" data-translate="action_mute">Мут</option>
                                    <option value="ban" data-translate="action_ban">Бан</option>
                                </select>
                                <input type="number" class="duration-input small-input" data-level="1" placeholder="хв">
                            </div>
                        </div>
                        <div class="punishment-rule">
                            <label data-translate="punishment_level_2">2-ге попередження</label>
                            <div class="punishment-controls">
                                <select class="action-selector" data-level="2">
                                    <option value="mute" data-translate="action_mute">Мут</option>
                                    <option value="ban" data-translate="action_ban">Бан</option>
                                </select>
                                <input type="number" class="duration-input small-input" data-level="2" placeholder="хв">
                            </div>
                        </div>
                        <div class="punishment-rule">
                            <label data-translate="punishment_level_3">3-тє попередження</label>
                            <div class="punishment-controls">
                                <select class="action-selector" data-level="3">
                                    <option value="mute" data-translate="action_mute">Мут</option>
                                    <option value="ban" data-translate="action_ban">Бан</option>
                                </select>
                                <input type="number" class="duration-input small-input" data-level="3" placeholder="хв">
                            </div>
                        </div>
                    </div>
                </section>

                <section class="card">
                    <h2 data-translate="spam_words_title">Керування спам-фільтром</h2>
                    <div class="setting-item">
                        <label data-translate="use_global_list_label">Використовувати глобальну базу</label>
                        <label class="switch">
                            <input type="checkbox" id="use-global-list-toggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label data-translate="use_custom_list_label">Використовувати локальну базу</label>
                        <label class="switch">
                            <input type="checkbox" id="use-custom-list-toggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <button id="manage-blocklist-btn" data-translate="manage_blocklist_btn" class="manage-list-btn">
                        Керувати Чорним списком
                    </button>
                    <button id="manage-whitelist-btn" data-translate="manage_whitelist_btn" class="manage-list-btn">
                        Керувати Білим списком
                    </button>
                </section>
            </div>
        </div>

        <!-- Сторінка статистики -->
        <div id="stats-page" class="page">
            <header class="page-header">
                <h1 data-translate="stats_title">Статистика</h1>
                <p class="subtitle" data-translate="stats_subtitle">Аналітика активності ваших груп</p>
            </header>

            <div class="card">
                <h2 data-translate="select_chat_for_stats">Виберіть групу для статистики</h2>
                <select id="stats-chat-selector" class="chat-selector">
                    <option value="" data-translate="loading_chats">Завантаження...</option>
                </select>

                <div class="period-selector">
                    <button class="period-btn active" data-days="7">7 днів</button>
                    <button class="period-btn" data-days="30">30 днів</button>
                    <button class="period-btn" data-days="90">90 днів</button>
                </div>
            </div>

            <div id="stats-container" class="hidden">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">📊</div>
                        <div class="stat-value" id="total-messages">0</div>
                        <div class="stat-label">Повідомлень</div>
                        <div class="stat-change positive">+0%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">🛡️</div>
                        <div class="stat-value" id="spam-blocked">0</div>
                        <div class="stat-label">Заблоковано спаму</div>
                        <div class="stat-change negative">0%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">👥</div>
                        <div class="stat-value" id="user-growth">0</div>
                        <div class="stat-label">Приріст користувачів</div>
                        <div class="stat-change positive">+0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">✅</div>
                        <div class="stat-value" id="captcha-success">0%</div>
                        <div class="stat-label">Успішність CAPTCHA</div>
                        <div class="stat-change">0/0</div>
                    </div>
                </div>

                <div class="card chart-card">
                    <h2>📈 Активність за період</h2>
                    <canvas id="activity-chart" style="max-height: 250px;"></canvas>
                </div>

                <div class="stats-columns">
                    <div class="card">
                        <h2>⚠️ Топ порушників</h2>
                        <div id="top-violators" class="violators-list">
                            <div class="loading-placeholder">Завантаження...</div>
                        </div>
                    </div>
                    <div class="card">
                        <h2>🕐 Активність по годинах</h2>
                        <canvas id="hourly-chart"></canvas>
                    </div>
                </div>

                <div class="card export-card">
                    <button class="export-btn button" id="export-stats-btn">
                        📥 Експортувати статистику (CSV)
                    </button>
                </div>
            </div>

            <div id="no-stats-data" class="card hidden">
                <p>📊 Немає даних для відображення.</p>
            </div>
        </div>

        <!-- Сторінка преміум -->
        <div id="premium-page" class="page">
            <header class="page-header">
                <h1 data-translate="premium_title">Преміум</h1>
            </header>
            <div class="card">
                <p data-translate="premium_stub_text">💎 Незабаром тут з'являться преміум-функції.</p>
            </div>
        </div>
    </main>

    <!-- Overlay для списків слів -->
    <div id="word-list-page" class="page-overlay hidden">
        <button id="back-to-settings-btn" class="fixed-back-btn">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M15 18l-6-6 6-6"/>
            </svg>
        </button>
        <div class="overlay-content">
            <h1 id="word-list-title">Список слів</h1>
            <div class="card" id="blocklist-add-card">
                <h3 data-translate="add_new_word_title">Додати нове слово</h3>
                <div class="input-row">
                    <input type="text" id="new-blocklist-word" placeholder="Спам-слово" class="input-field">
                    <input type="number" id="new-blocklist-score" min="1" max="100" value="10" class="input-score">
                </div>
                <button id="add-blocklist-btn" class="button-primary" data-translate="add_button">Додати</button>
            </div>

            <div class="card" id="whitelist-add-card" style="display: none;">
                <h3 data-translate="add_new_word_title_whitelist">Додати слово-виняток</h3>
                <input type="text" id="new-whitelist-word" placeholder="Слово-виняток" class="input-field" style="margin-bottom: 12px;">
                <button id="add-whitelist-btn" class="button-primary" data-translate="add_button">Додати</button>
            </div>

            <div class="card">
                <h3 data-translate="current_list">Поточний список</h3>
                <ul id="word-list-ul" class="word-list"></ul>
            </div>
        </div>
    </div>

    <!-- Нижня навігація з SVG іконками -->
    <nav id="bottom-nav">
        <button class="nav-btn active" data-page="home-page">
            <span class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                    <polyline points="9 22 9 12 15 12 15 22"/>
                </svg>
            </span>
            <span data-translate="nav_home">Головна</span>
        </button>

        <button class="nav-btn" data-page="settings-page">
            <span class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
                    <circle cx="12" cy="12" r="3"/>
                </svg>
            </span>
            <span data-translate="nav_settings">Налаштування</span>
        </button>

        <button class="nav-btn" data-page="stats-page">
            <span class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="20" x2="12" y2="10"/>
                    <line x1="18" y1="20" x2="18" y2="4"/>
                    <line x1="6" y1="20" x2="6" y2="16"/>
                </svg>
            </span>
            <span data-translate="nav_stats">Статистика</span>
        </button>

        <button class="nav-btn" data-page="premium-page">
            <span class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 3h12l4 6-10 13L2 9z"/>
                    <path d="M11 3 8 9l4 13 4-13-5-6"/>
                    <path d="M2 9h20"/>
                </svg>
            </span>
            <span data-translate="nav_premium">Преміум</span>
        </button>
    </nav>

    <!-- JavaScript -->
    <script src="js/app.js"></script>
</body>
</html>